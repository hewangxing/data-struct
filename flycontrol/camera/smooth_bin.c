//二值图像的中值滤波,3x1窗口
#include<stdio.h>
#define ROW 20 
#define COL 20

//黑点为1 白点为0
unsigned char image_array[ROW][COL] = 
	{
		1,0,0,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,
		0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
		0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,
		0,0,0,0,1,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,
		0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
		0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,
		1,0,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,
		0,0,0,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,
		0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,
		0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
		0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,
		0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,
		1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
		0,0,0,0,1,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,
		0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,
		1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,
		0,0,1,0,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,
		0,0,0,1,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,
		0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,	
		0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,
	};	
	
unsigned char image_smooth[ROW*COL] = {0};

int main(void)
{
	unsigned int i = 0, j = 0, k = 0;
	unsigned char last_num = 0, cur_num = 0, next_num = 0, bin_data = 0;
	
	//二值图像的中值滤波,3x1窗口
	for(i = 0; i < ROW; i++)
		for(j = 0; j <= COL; j++) 
		{		
			if(j > 0)//将矩阵往右推一个像素(col从1~20)时，cur_num从0~19
			{
				next_num = image_array[i][j];
			   
				switch(cur_num) //取相邻的三个数(0或1)中出现次数多的
				{
				  case 0x00:
					if(last_num&next_num)
					   bin_data|=0x01;
					else
					   bin_data&=0xfe;break;
				  case 0x01:
					if(last_num|next_num)
					   bin_data|=0x01;
					else
					   bin_data&=0xfe;break;
				}
				image_smooth[k++] = bin_data;	//存储滤波后的数据			
				last_num = cur_num; //依次往后递推
				cur_num = next_num;	
			}
		}

		/*打印输出
		for(k = 0; k < ROW*COL; k++)
		{
			if(k % COL == 0 && k != 0)
				printf("\n");
			printf("%d", image_smooth[k]);
			
		}*/
		
		//更新二值图像数组并打印输出
		k = 0;
		for(i = 0; i < ROW; i++)
		{
			for(j = 0; j < COL; j++)
			{
				
				image_array[i][j] = image_smooth[k++];
				printf("%d,", image_array[i][j]);
			}
			printf("\n");
		}
	return 0;
}

/*输出结果：
0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,
0,1,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,
1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,
0,0,0,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0，*/


